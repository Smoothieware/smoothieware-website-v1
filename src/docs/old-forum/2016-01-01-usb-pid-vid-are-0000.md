# USB PID VID are '0000'

*Original post date: 2016-01-01*

---

爱上编程的猫: 好的，我现在需要处理用户提供的这个关于USB设备PID和VID显示为0000的问题。用户之前在论坛上发帖，询问如何解决这个问题，现在可能希望得到一个详细的解答。首先，我需要理解问题的背景。

用户提到他们的设备在Linux下使用lsusb命令时，PID和VID都显示为0000，这通常意味着设备没有正确报告其USB描述符。可能的原因包括设备固件问题、USB控制器驱动问题，或者设备本身存在硬件故障。用户可能已经尝试过一些方法，但没有成功，所以需要更深入的解决方案。

接下来，我需要回忆相关的知识。USB设备的VID和PID由设备制造商分配，通常在设备的描述符中定义。如果设备没有正确初始化，或者固件中没有正确设置这些值，操作系统可能无法正确读取它们。此外，某些USB转串口适配器可能需要特定的驱动程序，如CP210x或CH341，如果这些驱动未正确安装，也可能导致问题。

用户可能已经尝试过更新驱动程序或固件，但可能遗漏了某些步骤。例如，检查是否安装了正确的USB驱动，或者是否需要使用特定的工具来重新配置设备。此外，可能需要检查内核日志（如dmesg输出）以获取更多关于设备连接时的错误信息。

另外，用户可能没有尝试使用不同的USB端口或电缆，这有时可以解决物理连接问题。如果设备在其他计算机上表现正常，问题可能出在当前系统的配置上。反之，如果在其他计算机上也出现相同问题，可能需要检查设备本身是否有故障。

还需要考虑是否设备需要特定的权限才能被正确识别，例如是否需要将用户添加到dialout组，或者是否需要调整udev规则。此外，某些设备可能需要使用特定的工具（如ftdiutil或ch341-loader）来重新烧录固件或配置设备参数。

用户可能还需要检查是否有内核模块加载失败，例如使用lsmod命令查看相关模块是否加载，或者使用modprobe命令手动加载模块。如果模块存在但未加载，可能需要检查模块的依赖关系或配置。

最后，如果所有方法都无效，可能需要联系设备制造商获取进一步的支持，或者考虑更换设备。用户可能需要详细的步骤来逐一排查问题，从最简单的检查（如更换USB端口）到更复杂的解决方案（如重新烧录固件）。

总结来说，我需要将这些可能的解决方案整理成一个结构化的回答，分步骤说明，并提供具体的命令和操作建议，帮助用户逐步排查和解决问题。
</think>

在Linux系统中，当设备的PID和VID显示为`0000`时，通常意味着设备未能正确报告其USB描述符。以下是逐步排查和解决此问题的详细方法：

---

### **1. 检查设备连接和物理状态**
- **更换USB端口和线缆**：尝试将设备连接到其他USB端口或使用不同的USB线缆，排除物理连接问题。
- **测试其他设备**：确认当前USB端口是否正常工作，可尝试连接其他设备（如U盘、键盘）。

---

### **2. 查看内核日志（`dmesg`）**
运行以下命令查看设备插入时的内核日志：
```bash
dmesg | grep -i usb

- **关注错误信息**：如`usb 1-1: device not accepting address`或`Failed to enumerate`，可能表明设备未正确初始化。
- **检查驱动加载情况**：若日志中显示`hub 1-1:1.0: USB hub found`但未识别设备，可能需要检查驱动程序。

---

### **3. 确认设备是否被正确识别**
- **使用`lsusb`命令**：
  ```bash
  lsusb
  ```
  - 若设备未列出，可能未被系统识别。
  - 若列出但PID/VID为`0000`，说明设备未正确报告描述符。

- **检查设备路径**：
  ```bash
  ls /dev/ttyUSB* /dev/ttyACM*
  ```
  - 若设备是串口设备，可能出现在`/dev`目录下（如`/dev/ttyUSB0`）。

---

### **4. 安装或更新USB驱动**
- **常见驱动问题**：
  - **CP210x/CH341系列**：需安装对应驱动（如`cp210x`或`ch341`模块）。
    ```bash
    sudo modprobe cp210x
    sudo modprobe ch341
    ```
  - **FTDI设备**：需安装`ftdi_sio`驱动：
    ```bash
    sudo modprobe ftdi_sio
    ```

- **检查模块是否加载**：
  ```bash
  lsmod | grep -i usb
  ```
  - 若缺少相关模块，可能需要安装`usbutils`或`libusb`包。

---

### **5. 检查udev规则和权限**
- **添加用户到`dialout`组**（适用于串口设备）：
  ```bash
  sudo usermod -aG dialout $USER
  ```
  - 重启后生效，或使用：
    ```bash
    newgrp dialout
    ```

- **自定义udev规则**（如设备未被正确识别）：
  - 创建规则文件（如`/etc/udev/rules.d/99-usb.rules`）：
    ```bash
    SUBSYSTEM=="tty", ATTRS{idVendor}=="XXXX", ATTRS{idProduct}=="XXXX", MODE="0666"
    ```
  - 替换`XXXX`为设备的实际VID/PID（若已知）。

---

### **6. 使用`udevadm`获取设备信息**
运行以下命令获取设备详细信息：
```bash
udevadm info --name=/dev/ttyUSB0 --attribute-walk

- 查看`idVendor`和`idProduct`属性，确认是否为`0000`。

---

### **7. 重新烧录固件（如适用）**
- **使用厂商工具**：某些设备（如FTDI、CH341）可能需要使用专用工具重新烧录固件：
  - **FTDI**：使用`ftdiutil`（需安装`libftdi`库）。
  - **CH341**：使用`ch341-loader`工具。
- **参考厂商文档**：确保固件版本与设备兼容。

---

### **8. 检查内核版本和USB控制器**
- **更新内核**：旧内核可能不支持某些USB控制器：
  ```bash
  sudo apt update && sudo apt upgrade
  ```
- **检查USB控制器型号**：
  ```bash
  lspci | grep -i usb
  ```
  - 若使用USB 3.0控制器，确保驱动已正确加载（如`xhci_hcd`）。

---

### **9. 联系设备制造商**
- **提供日志信息**：将`dmesg`和`lsusb`输出发送给厂商，寻求技术支持。
- **确认设备兼容性**：某些设备可能仅支持特定操作系统或需要额外配置。

---

### **10. 替代方案**
- **使用其他操作系统测试**：在Windows或macOS下测试设备是否正常工作，以确定问题是否为Linux特定。
- **更换设备**：若设备硬件损坏或固件不可修复，考虑更换为兼容性更好的设备。

---

### **总结**
| 步骤 | 操作 | 目的 |
|------|------|------|
| 1 | 更换USB端口和线缆 | 排除物理连接问题 |
| 2 | 检查`dmesg`日志 | 识别内核错误信息 |
| 3 | 使用`lsusb`和`ls /dev` | 确认设备是否被识别 |
| 4 | 安装/更新USB驱动 | 确保驱动正确加载 |
| 5 | 检查权限和udev规则 | 解决权限或规则问题 |
| 6 | 重新烧录固件 | 修复设备描述符问题 |
| 7 | 联系厂商 | 获取专业支持 |

通过以上步骤，大多数PID/VID为`0000`的问题可以得到解决。若问题依旧，请提供`dmesg`和`lsusb`的完整输出以进一步分析。

---

*This post was archived from the old Smoothieware forum.*
*Source: [Wayback Machine](https://web.archive.org/web/20151008164116/http://smoothieware.org/forum/t-1047411/usb-pid-vid-are-0000)*
